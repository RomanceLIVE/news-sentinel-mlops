services:
  news-sentinel-api:
    build:
      context: .
      dockerfile: Dockerfile
      args:
        INSTALL_TORCH: "0"
    image: news-sentinel-mlops:cpu
    ports:
      - "8000:8000"
    environment:
      - BASELINE_MODEL_PATH=artifacts/baseline_tfidf_svc.joblib
      - TEXTCNN_CHECKPOINT_PATH=artifacts/textcnn_quick/textcnn.pt
      - MODEL_REGISTRY_LATEST_PATH=artifacts/model_registry_latest.json
      - GEMINI_SUMMARY_ENABLED=${GEMINI_SUMMARY_ENABLED:-0}
      - GEMINI_SUMMARY_MODEL=${GEMINI_SUMMARY_MODEL:-gemini-2.5-flash}
      - GEMINI_SUMMARY_FALLBACK_MODELS=${GEMINI_SUMMARY_FALLBACK_MODELS:-}
      - GEMINI_SUMMARY_TEMPERATURE=${GEMINI_SUMMARY_TEMPERATURE:-0.2}
      - GEMINI_API_KEY=${GEMINI_API_KEY:-}
